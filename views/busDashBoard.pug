extends base
block Indexcss
block content
block script                  
        section(style='margin-top: 50px;')
            .container.my-5
                if (businessUser.isEmailVerified === false)
                    .card.py-2.px-3(style = "background-color: red; color: white; margin-top: 50px;")
                        p Kindly Check your Email and click on the link provided to verify your email. If you didn't received the email 
                            a#request-verify-email_btn(href="#") Request a New one
            .container
                .row
                    .col-6
                        h4= `Hello, ${businessAccount.businessName}`
                        a.mx-1(href='#') View and Edit Profile
                .col-6
        .container
            .row.my-5
                #card2.col-12.col-md-6.col-xl-4
                    .card.border-1.shadow-sm
                        .card-body.py-5
                            h6 RiraPay Wallet Balance
                            h3  &#x20A6;0.00
                #card2.col-12.col-md-6.col-xl-4
                    .card.border-1.shadow-sm
                        .card-body.py-5
                            h6 Sales
                            .btn-group
                            a.btn#button-sales.btn.btn-sm.dropdown-toggle.justify-content-end(type='button', data-toggle='dropdown', aria-haspopup='true', aria-expanded='false')
                                | Today
                            #dropdownbtn.dropdown-menu.sales-today
                                a#salesToday_btn(href='#sumOfSalesToday') Today
                                a#salesWeekly_btn(href='#sumOfSalesWeek') This Week
                                a#salesMonthly_btn(href='') This Month
                                a#salesLifeTime_btn(href='#sumOfSalesLifetime') Lifetime                      
                            .sumOfSalesResult(style='display: flex;')
                                h3#sumOfSalesResult.sales-toggle=`₦ ${salesToday}`
                                #loading-Sales-Result
                            
                                                
                                        
                #card2.col-12.col-md-6.col-xl-4
                    .card.border-1.shadow-sm
                        .card-body.py-5
                            h6 Transactions
                            .btn-group
                            a.btn#button-trans.btn.btn-sm.dropdown-toggle.justify-content-end(type='button', data-toggle='dropdown', aria-haspopup='true', aria-expanded='false')
                                | Today
                            #dropdownbtn.dropdown-menu.trans-today
                                a#transToday_btn(href='#sumOfTransToday') Today
                                a#transWeekly_btn(href='#sumOfTransWeek') This Week
                                a#transMonthly_btn(href='#sumOfTransMonth') This Month
                                a#transLifeTime_btn(href='#sumOfTransLifetime') Lifetime
                            .sumOfTransResult(style='display: flex;')
                                h3#sumOfTransResult.trans-toggle=`₦ ${transToday}`
                                #loading-Trans-Result

        section.large-view-table
            .large-container.mb-5
                .row
                    .col-12
                            .card-body.py-5.mx-2
                                ul.list-group
                                        li.d-flex.justify-content-between
                                            h4.d-flex.justify-content-between Latest Orders:
                                - const busOrder = businessAccount.orders;
                                if (busOrder.length)
                                    table.table.table-condensed.table-hover                       
                                        thead
                                            tr
                                                th Date
                                                th Product Name
                                                th Status
                                                th Customer
                                                th State
                                                th Amount
                                                th Tags

                                        tbody
                                            each orders in businessAccount.orders.reverse().slice(0, 10)
                                                each product in orders.product
                                                    //- -console.log(orders.product);

                                                    -const Date = moment(orders.createdAt).format('dddd, MMMM Do YYYY, h:mm:ss a');
                                                    -const orderTotal = orders.total.toLocaleString()

                                                    tr.table-row(style= 'height: 65px' data-href=`/myorder/${product.id}/${orders._id}`)
                                                    
                                                        td
                                                            a(href=`/myorder/${product.id}/${orders._id}`)=Date
                                                                                                
                                                        td
                                                            a(href=`/myorder/${product.id}/${orders._id}`)= product.productName
                                                        td
                                                            a(href=`/myorder/${product.id}/${orders._id}`)= orders.status
                                                        td
                                                            a(href=`/myorder/${product.id}/${orders._id}`)=orders.name
                                                        td
                                                            a(href=`/myorder/${product.id}/${orders._id}`)=orders.state                             
                                                        td
                                                            a(href=`/myorder/${product.id}/${orders._id}`)=`₦${orderTotal}`
                                                        td(colspan='2')
                                                            a(href=`/myorder/${product.id}/${orders._id}`)=orders.tags
                                            //- if (!orders)
                                            //-     .text-center
                                            //-         p You have no Orders Right now. Create a Product and Start Selling!
                                                
                                    .text-center.mb-3
                                        h6
                                            a(href='/allorders') View All orders
                                if (!busOrder.length)
                                    .text-center
                                        p.mt-2(style='font-size: 1.2rem;') You don't have an order for now. Create a new product and share the link to your customers to pay through RiraPay
                                    .text-center
                                        a(style='font-size: 1.2rem;' href='/createproduct') Create New Product                             
        section.large-view-table
            .large-container
                .row
                    .col-12                        
                        .card-body.py-5.mx-2
                                ul.list-group
                                    li.d-flex.justify-content-between
                                        h4.d-flex.justify-content-between Latest Products:  
                                        h6
                                            a(href='/createproduct') Create New Product
                            
                                table.table.table-condensed.table-hover                       
                                    thead
                                        tr
                                            th Date
                                            th Product Name
                                            th Stock
                                            th Amount

                                    tbody
                                        each product in businessAccount.products.reverse().slice(0, 10)
                                            - const Date = moment(product.date).format('dddd, MMMM Do YYYY, h:mm:ss a');
                                            -const productprice = product.price.toLocaleString()

                                            tr.table-row(data-href=`/myproduct/${product.slug}/${product._id}`)
                                        
                                                td
                                                    a(href=`/myproduct/${product.slug}/${product._id}`)=Date
                                                td
                                                    a(href=`/myproduct/${product.slug}/${product._id}`)=product.productName
                                                td
                                                    a(href=`/myproduct/${product.slug}/${product._id}`)=product.stock                                
                                                td
                                                    a(href=`/myproduct/${product.slug}/${product._id}`)= `₦${productprice}`
                                        
                                .text-center.mb-3
                                    h6
                                        a(href='/allproducts') View All Products

        section
            .small-container
                ul.list-group.my-4
                    li.d-flex.justify-content-between
                    h4.d-flex.justify-content-between Latest Orders:
                if (busOrder.length)
                    each orders in businessAccount.orders.slice(0, 13)
                        each product in orders.product
                            -const orderTotal = orders.total.toLocaleString()
                            -const mobiledate = moment(orders.createdAt).format('MMM DD');
                            -const shtOrderName = orders.name.split(" ").splice(0,2).join(" ")
                            -const shtOrderState = orders.state.split(" ").splice(0,1).join(" ")
                            -const shtProductName = product.productName.split(" ").splice(0,2).join(" ")

                            if (orders.altPhone)
                                -var copiedInfo= `Product Name: ${product.productName}\n\nName: ${orders.name}\n\nAddress: ${orders.address}\n\nState: ${orders.state}\n\nArea: ${orders.area}\n\nQuantity: ${orders.qty}\n\nAmount Receiving: ₦${orderTotal}\n\nPhone Number: ${orders.phone}\n\nAlternative Number: ${orders.altPhone}`;
                            else
                                -var copiedInfo= `Product Name: ${product.productName}\n\nName: ${orders.name}\n\nAddress: ${orders.address}\n\nState: ${orders.state}\n\nArea: ${orders.area}\n\nQuantity: ${orders.qty}\n\nAmount Receiving: ₦${orderTotal}\n\nPhone Number: ${orders.phone}`;


                            .mini-table(data-href=`/myorder/${product.id}/${orders._id}`)
                                .row.clickable-row.no-gutters.mx-3.py-2.px-2.border-top
                                    .col-8
                                        p.m-0 
                                            a(target='_blank' href=`/myorder/${product.id}/${orders._id}`)
                                                b= `₦${orderTotal}`
                                        p.m-0 
                                            a(target='_blank' href=`/myorder/${product.id}/${orders._id}`)= shtOrderName
                                        
                                        p.m-0 
                                            a(target='_blank' href=`/myorder/${product.id}/${orders._id}`)= shtProductName
                                    .col-4
                                        p.m-0 
                                            a(target='_blank' href=`/myorder/${product.id}/${orders._id}`)= orders.status
                                            
                                        p.m-0 
                                            a(target='_blank' href=`/myorder/${product.id}/${orders._id}`)= mobiledate
                                        p.m-0 
                                        a(target='_blank' href=`/myorder/${product.id}/${orders._id}`)= shtOrderState
                            .row.border-bottom(style='font-weight: 500;')
                                .col-3
                                    .ml-5
                                        a(style='color: black;' href=`tel:${orders.phone}`) 
                                            i.lni.lni-phone
                                .col-3
                                    .ml-5
                                        button( style='border: 0;border-color: transparent; background-color: transparent;' data-sharer='whatsapp', data-title="" data-url=`${copiedInfo}`)
                                            i.far.fa-share-square
                                .col-3
                                    .ml-5
                                        button.clipboard-btn(style='border: 0;border-color: transparent; background-color: transparent;' data-clipboard-text=`${copiedInfo}`)
                                            i.far.fa-copy
                    .text-center.my-3
                        h6
                            a.btn.btn-lg.rira-color-btn(href='/mobileorders') View all orders

                if (!busOrder.length)
                    .text-center
                        p.mt-2(style='font-size: 1.2rem;') You don't have an order for now. Create a new product and share the link to your customers to pay through RiraPay
                    .text-center
                        a.rira-color-btn.btn(href='/createproduct') Create your first Product


        section(style = 'margin-top: 150px;')
            .small-container
                - const busproducts = businessAccount.products;
                if (busproducts.length)
                    ul.list-group.my-4
                        li.d-flex.justify-content-between
                            h4.d-flex.justify-content-between Latest Product:
                            a.rira-color-btn.btn(href='/createproduct') Create New Product
                    each product in businessAccount.products.slice(0, 10)
                        -const productprice = product.price.toLocaleString()
                        - const mobiledate = moment(product.date).format('DD/MMM/YY');

                        .mini-table(data-href=`/myproduct/${product.slug}/${product._id}`)
                            .row.clickable-row.no-gutters.mx-3.py-2.px-2.border-top.border-bottom
                                .col-9
                                    p.m-0 
                                        a(target='_blank' href=`/myproduct/${product.slug}/${product._id}`)
                                            b= `${product.productName}`
                                    p.m-0 
                                        a(target='_blank' href=`/myproduct/${product.slug}/${product._id}`)= `Stock: ${product.stock}`
                                    p.m-0 
                                        a(target='_blank' href=`/myproduct/${product.slug}/${product._id}`)= `Price: ₦${productprice}`
                                .col-3
                                    p.mt-3
                                    a(target='_blank' href=`/myproduct/${product.slug}/${product._id}`)= mobiledate
                    .text-center.my-3
                        h6
                            a.rira-color-btn.btn(href='/allproducts') View All Products
                if (!busproducts.length)
                    .text-center
                        p.mt-2(style='font-size: 1.2rem;') Create your first product and share to your social media buyers
                    .text-center
                        a.rira-color-btn.btn(href='/createproduct') Create your first Product
            
            input#salesTransBusinessAccountID(type="text", hidden="", value=`${businessAccount.id}`)
            